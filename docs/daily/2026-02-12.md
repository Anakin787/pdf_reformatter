# 작업일지 — 2026-02-12 (수)

## 요약

정밀 대조 결과 페이지 분석 고도화 및 레이아웃 최적화.
비교문서정보 표 제외, 출처 URL 추출, 페이지당 카드 동적 배치 적용.

---

## 변경 파일

- `PDF_Reformatter.html`

---

## 상세 작업 내역

### 1. Gemini 프롬프트 — 비교문서정보 표 제외

- 카피킬러 PDF에 포함된 "비교문서정보" 표(문서제목, 파일형식, 등록일, 문서종류 등 메타정보 테이블)를 분석 대상에서 완전히 제외
- `analyzeWithGemini` 프롬프트에 절대 규칙 추가: 비교문서정보 표의 어떤 정보(URL, 문서제목 등)도 `comparisons`에 포함 금지
- 오직 문장별 대조 비교 카드에서만 데이터를 추출하도록 명시

### 2. 비교문헌 출처 URL 추출 및 표시

- Gemini 프롬프트의 `source` 객체에 `url` 필드 추가
- 문장별 대조 비교 카드의 출처 영역에 표시된 URL/링크만 추출 (비교문서정보 표의 URL은 사용 금지)
- 비교문헌 블럭 템플릿에 URL 링크 표시 추가 (`v-if="comp.source.url"` → 클릭 가능한 파란색 링크)

### 3. CopyClean Matching DB 칩 제거

- 비교문헌(plagiarism) 블럭 하단의 초록 배경 `CopyClean Matching DB` 칩(`comp-match-badge`) 삭제

### 4. PDF 분석 페이지 제한 확대

- `maxPages` 제한: 10 → 15로 변경
- 더 많은 페이지의 비교 결과를 분석/추출 가능

### 5. 카드 레이아웃 컴팩트화

- 카드 전반 스타일 조정: 패딩, 마진, 폰트 사이즈 축소
  - content-padding: `32px 36px` → `28px 32px`
  - 카드 margin-bottom: `16px` → `12px`
  - 본문 폰트: `11.5px` → `11px`, 출처: `10.5px` → `10px`
  - quote 블럭: `10.5px` → `9.5px`
- 페이지 푸터(저작권 표시) 하단 고정: `.content-padding`에 `display:flex; flex-direction:column` 추가 → `margin-top:auto` 작동

### 6. 카드 높이 기반 동적 페이지 재배치

**이전:** 고정 `ITEMS_PER_PAGE = 2` (→ 4) 개씩 균등 분배
**이후:** 렌더링 후 실제 카드 높이(`offsetHeight`) 측정하여 동적 분배

- 모든 카드를 임시로 한 페이지에 렌더링
- 각 카드의 실제 높이를 `offsetHeight + marginBottom`으로 측정
- 페이지 가용 영역(`1123px - 패딩 - 헤더 - 푸터`)에 맞춰 자동 분배
- 첫 페이지(대제목 헤더 60px)와 이후 페이지(간략 헤더 35px) 높이 차이 반영
- 텍스트가 긴 카드는 적게, 짧은 카드는 많이 → 여백 최소화

---

## 커밋 이력

1. `3f481fb` — feat: 정밀 대조 결과 레이아웃 개선 및 분석 고도화
2. `5472051` — feat: 카드 높이 기반 동적 페이지 재배치

---

## 미변경 영역 (보호)

- PAGE 1~3 HTML 템플릿 및 관련 JS 데이터
- PDF 변환/다운로드 로직
- STEP 1~3 메타데이터 추출 및 텍스트 분석 흐름
- AI 유사도 블럭의 `AI Pattern DB` 칩은 유지
